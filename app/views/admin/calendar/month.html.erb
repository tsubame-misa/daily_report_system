<div class="calendar-header">
  <div class="calendar-header-left">
    <%= link_to '‰ªäÊúà', admin_calendar_month_path(month: Date.today.strftime('%Y-%m')), class: 'today-button' %>
    <div class="arrow-buttons">
      <%= link_to admin_calendar_month_path(month: @prev_month), class: 'arrow-button' do %>
        <i class="bi bi-chevron-left"></i>
      <% end %>
      <%= link_to admin_calendar_month_path(month: @next_month), class: 'arrow-button' do %>
      <i class="bi bi-chevron-right"></i>
    <% end %>
    </div>
    <p class="text-center mb-0 fs-5"><%= @selected_year %>Âπ¥ <%= @selected_month %>Êúà</p>
  </div>
  <div class="calendar-header-right">
    <div class="search_bar_container">
      <%= render_search_bar(path: admin_calendar_month_path(month: @selected_month)) %>
    </div>
    <div class="btn-group rounded-pill border overflow-hidden" role="group">
      <%= link_to admin_calendar_month_path(month: @selected_date.strftime('%Y-%m')), 
          class: "btn ps-3 pe-3 py-2 d-flex align-items-center justify-content-center #{action_name == 'month' ? 'text-dark' : 'bg-dark text-white-50'}",
          title: "ÊúàÂà•Ë°®Á§∫" do %>
          <i class="bi bi-calendar3"></i>
      <% end %>

      <%= link_to admin_calendar_day_path(date: @selected_date.strftime('%Y-%m-%d')), 
          class: "btn px-3 py-2 d-flex align-items-center justify-content-center #{action_name == 'day' ? 'text-dark' : 'bg-dark text-white-50'}",
          title: "Êó•Âà•Ë°®Á§∫" do %>
          <i class="bi bi-calendar3-event"></i>
      <% end %>
    </div>
  </div>
</div>

<!-- üìÖ „Ç´„É¨„É≥„ÉÄ„ÉºË°®Á§∫ -->
<table class="calendar">
  <thead>
    <tr>
      <% %w[Êó• Êúà ÁÅ´ Ê∞¥ Êú® Èáë Âúü].each do |day| %>
        <th><%= day %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @dates.each do |week| %>
      <tr>
        <% week.each do |date| %>
          <td class="<%= 'outside-month' if date.month != @selected_month %>">
            <div class="date-label">
              <% if request.path.start_with?('/admin') %>
                <%= link_to date.day, admin_calendar_day_path(date: date.strftime('%Y-%m-%d')), class: "text-decoration-none text-dark" %>
              <% else %>
                <span class="text-dark"><%= date.day %></span>
              <% end %>
            </div>
            <div class="report-list">
              <% @calendar_preview_reports[date]&.each do |report| %>
                <div class="report-item">
                  <%= link_to request.path.start_with?('/admin') ? admin_report_path(report) : report_path(report), class: "d-flex align-items-center gap-1" do %>
                    <% if defined?(current_user) && report.favorites.exists?(user_id: current_user.id) %>
                      <i class="bi bi-heart-fill"></i>
                    <% else %>
                      <i class="bi bi-heart"></i>
                    <% end %>
                    <% if request.path.start_with?('/admin') %>
                      <span class="report-content"><%= report.user.name %></span>
                    <% else %>
                      <span class="report-content title"><%= report.title %></span>
                    <% end %>
                  <% end %>
                </div>
              <% end %>
              <% if request.path.start_with?('/admin') && @reports_count_by_date[date].to_i > 3 %>
                <div class="more-link">
                  <%= link_to admin_calendar_day_path(date: date.strftime('%Y-%m-%d')), class: "text-decoration-none text-primary" do %>
                    <small>„ÇÇ„Å£„Å®Ë¶ã„Çã</small>
                  <% end %>
                </div>
              <% end %>
            </div>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

